<script>
  document.addEventListener("DOMContentLoaded", () => {
    const card = document.getElementById('card');
    const openBtn = document.getElementById('openBtn');
    const yesBtn = document.getElementById('yesBtn');
    const thanks = document.getElementById('thanks');
    const rsvpForm = document.getElementById('rsvpForm');

    // If something is missing, don't crashâ€”show a helpful error.
    if (!card || !openBtn || !yesBtn || !thanks || !rsvpForm) {
      console.error("Missing element(s):", {
        card: !!card,
        openBtn: !!openBtn,
        yesBtn: !!yesBtn,
        thanks: !!thanks,
        rsvpForm: !!rsvpForm
      });
      return;
    }

    openBtn.addEventListener('click', () => card.classList.toggle('open'));

    rsvpForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      yesBtn.disabled = true;
      yesBtn.textContent = "Sendingâ€¦ ðŸ’Œ";

      try {
        const resp = await fetch(rsvpForm.action, {
          method: "POST",
          body: new FormData(rsvpForm),
          headers: { "Accept": "application/json" }
        });

        if (resp.ok) {
          thanks.classList.remove('hidden');
          yesBtn.textContent = "Yes (sent!) ðŸ’˜";
        } else {
          yesBtn.disabled = false;
          yesBtn.textContent = "Yes ðŸ’–";
          alert("Hmmâ€”couldn't send. Try again?");
        }
      } catch (err) {
        console.error(err);
        yesBtn.disabled = false;
        yesBtn.textContent = "Yes ðŸ’–";
        alert("Network errorâ€”try again?");
      }
    });
  });
</script>


